<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Hello World!</title>
  <style>
    body {
      height: 100vh;
    }

    .trim-canvas {
      position: absolute;
      top: 0px;
      left: 0px;
    }

    .file-select {
      width: 200px;
    }

    .container {
      display: flex;
      height: 100%;
    }

    .left {
      width: 300px;
      background-color: black;
    }

    .right {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .top {
      flex: 2;
      background-color: red;
    }

    .bottom {
      height: 300px;
      background-color: green;
    }
  </style>
  <!--
  <script>
    const $ = (q) => document.querySelector(q);
    const $$ = (q) => document.querySelectorAll(q);

    /**
     * dragFocusLayer はマウスドラッグでトリミング位置を変更する
     */
    function dragFocusLayer(event) {
      const LEFT_CLICK = 1;
      if (event.buttons !== LEFT_CLICK) return;
      updateTrimingLayger(event);
    }

    /**
     * updateTrimingLayger はtトリミング位置のフォーカスを更新する。
     * @param {*} param0 
     * @param {*} event 
     */
    function updateTrimingLayger(event) {
      let foc = $("#focusLayerCanvas");
      // カーソル位置をトリミング範囲の中央にするために / 2
      const x = event.offsetX - foc.width / 2;
      const y = event.offsetY - foc.height / 2;
      foc.x = x;
      foc.y = y;
      moveFocus();
    }

    /**
     * moveFocus はトリミング位置のレイヤーを移動する。
     * 上下左右のレイヤを更新し、トリミング位置だけcanvas描画を消す。
     * @param {*} state 
     */
    function moveFocus(state) {
      const canvas = $("#focusLayerCanvas")
      const context = canvas.getContext("2d");
      context.clearRect(0, 0, canvas.width, canvas.height);

      const layer = Util.calcLayerRects(
        state.focusLayer.focus.x,
        state.focusLayer.focus.y,
        state.focusLayer.focus.width,
        state.focusLayer.focus.height,
        state.width,
        state.height);

      // 上下左右の位置を描画
      context.fillStyle = "rgba(0, 0, 0, 0.3)";
      const fill = (r) => context.fillRect(r.x, r.y, r.width, r.height);
      const bgRect = layer.backgroundRects;
      fill(bgRect.top);
      fill(bgRect.right);
      fill(bgRect.bottom);
      fill(bgRect.left);

      // トリミング位置のcanvas描画を削除
      const foc = layer.focusRect;
      context.clearRect(foc.x, foc.y, foc.width, foc.height);
    }
  </script>
-->
</head>

<body>
  <div class="container">
    <div class="left">
      <h1>画像選択</h1>
      <select name="imageFileSelect" id="imageFileSelect" class="file-select" multiple size="20">
      </select>
    </div>
    <div class="right">
      <div class="top">
        <h1>トリミング位置</h1>
        <div id="trimImagePane" style="position: relative; width: 100%; height: 500px; overflow: scroll;">
          <canvas id="trimPreviewCanvas" class="trim-canvas">
          </canvas>
          <canvas id="focusLayerCanvas" class="trim-canvas">
          </canvas>
        </div>
        <!-- <div id="trimImagePane">
          <canvas id="trimPreviewCanvas">
          </canvas>
          <canvas id="focusLayerCanvas">
          </canvas>
        </div> -->
      </div>
      <div class="bottom">
        <h1>出力画像プレビュー</h1>
        <canvas id="outputPreviewCanvas"></canvas>
      </div>
    </div>
  </div>
  <script src="index.js"> </script>
</body>

</html>